{"version":3,"sources":["webpack:///./node_modules/terriajs/lib/ReactViews/Tools/DeltaTool/DeltaTool.jsx","webpack:///./node_modules/terriajs/lib/ReactViews/Tools/DeltaTool/DatePickers.jsx","webpack:///./node_modules/terriajs/lib/ReactViews/Tools/DeltaTool/LocationPicker.jsx","webpack:///./node_modules/terriajs/lib/ReactViews/Tools/DeltaTool/delta-tool.scss"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","Object","defineProperty","exports","value","_dateformat","_interopRequireDefault","_propTypes","_react","__esModule","cache","_getRequireWildcardCache","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","key","hasOwnProperty","call","desc","set","_interopRequireWildcard","_raiseErrorToUser","_deltaTool","_DatePickers","_LocationPicker","_duplicateItem","_prettifyCoordinates","_reactI18next","WeakMap","_slicedToArray","arr","i","Array","isArray","_arrayWithHoles","toString","_arr","_n","_d","_e","undefined","_s","_i","next","done","push","length","err","_iterableToArrayLimit","TypeError","_nonIterableRest","DeltaTool","_ref","terria","tool","onCloseTool","t","type","catalogItem","item","supportsDeltaComparison","_useState2","useState","setItem","_useState4","location","setLocation","_useState6","discreteTime","primaryDate","setPrimaryDate","_useState8","secondaryDate","setSecondaryDate","_useState10","beforePick","afterPick","pickerMessages","setPickerMessages","useEffect","isShown","newItem","name","isEnabled","useOwnClock","createElement","className","deltaTool","title","body","PrettyLocation","buttons","cancelBtn","onClick","generateDeltaBtn","timestamp","Date","concat","featureTimesProperty","clock","intervals","disableUserChanges","firstDateStr","dateDisplayFormat","secondDateStr","shortReport","split","map","ln","trim","join","firstDateParam","dateParamFormat","secondDateParam","parameters","showDeltaImagery","disabled","onPick","picked","latLong","feature","features","imageryLayer","filterIntervalsByFeature","availableDates","_availableDates$slice2","slice","setDatesFromAvailableDates","e","messages","_ref2","useTranslation","prettyLocation","longitude","latitude","date","propTypes","object","isRequired","func","displayName","_default","withTranslation","_defined","_DateFormats","_DateTimePicker","_Icon","DatePickers","pickers","useDatePickerState","_setIsOpen","pickerId","isOpen","_ref3","thisPicker","otherPicker","setIsOpen","dateFormatting","dateFormat","currentTime","datePickers","DatePicker","setDate","_ref4","formattedDate","formatDateTime","_findNextAndPrevDates","dateIndex","indexOf","prevDate","nextDate","findNextAndPrevDates","pickerButtons","previousDate","glyph","GLYPHS","previous","currentDate","stopPropagation","picker","dates","onChange","popupStyle","datePickerPopup","openDirection","showCalendarButton","onOpen","onClose","array","string","bool","_Ellipsoid","_Math","_knockout","_LocationMarkerUtils","_MapInteractionMode","_Loader","LocationPicker","currentPick","pickPointMode","message","mapInteractionModeStack","showMarker","subscription","getObservable","subscribe","thisPick","customUi","cartesian","carto","position","pickPosition","WGS84","cartesianToCartographic","toDegrees","allFeaturesAvailablePromise","then","dispose","stopInteractionMode","removeMarker","addMarker","pop","module"],"mappings":"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","file":"7.TerriaMap.js","sourcesContent":["\"use strict\";\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _dateformat = _interopRequireDefault(require(\"dateformat\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _raiseErrorToUser = _interopRequireDefault(require(\"../../../Models/raiseErrorToUser\"));\n\nvar _deltaTool = _interopRequireDefault(require(\"./delta-tool.scss\"));\n\nvar _DatePickers = _interopRequireDefault(require(\"./DatePickers\"));\n\nvar _LocationPicker = _interopRequireDefault(require(\"./LocationPicker\"));\n\nvar _duplicateItem = _interopRequireDefault(require(\"../../../Models/duplicateItem\"));\n\nvar _prettifyCoordinates = _interopRequireDefault(require(\"../../../Map/prettifyCoordinates\"));\n\nvar _reactI18next = require(\"react-i18next\");\n\nfunction _getRequireWildcardCache() { if (typeof WeakMap !== \"function\") return null; var cache = new WeakMap(); _getRequireWildcardCache = function _getRequireWildcardCache() { return cache; }; return cache; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\n/**\n * A tool for comparing imagery at two points in time.\n */\nfunction DeltaTool(_ref) {\n  var terria = _ref.terria,\n      tool = _ref.tool,\n      onCloseTool = _ref.onCloseTool,\n      t = _ref.t;\n  var type = tool.type,\n      catalogItem = tool.item;\n\n  if (type !== \"delta\" || !(catalogItem && catalogItem.supportsDeltaComparison)) {\n    return null;\n  }\n\n  var _useState = (0, _react.useState)(undefined),\n      _useState2 = _slicedToArray(_useState, 2),\n      item = _useState2[0],\n      setItem = _useState2[1];\n\n  var _useState3 = (0, _react.useState)(undefined),\n      _useState4 = _slicedToArray(_useState3, 2),\n      location = _useState4[0],\n      setLocation = _useState4[1];\n\n  var _useState5 = (0, _react.useState)(catalogItem.discreteTime),\n      _useState6 = _slicedToArray(_useState5, 2),\n      primaryDate = _useState6[0],\n      setPrimaryDate = _useState6[1];\n\n  var _useState7 = (0, _react.useState)(catalogItem.discreteTime),\n      _useState8 = _slicedToArray(_useState7, 2),\n      secondaryDate = _useState8[0],\n      setSecondaryDate = _useState8[1];\n\n  var _useState9 = (0, _react.useState)({\n    beforePick: \"Select a point by clicking on the map\",\n    afterPick: \"Click another point to change the selection\"\n  }),\n      _useState10 = _slicedToArray(_useState9, 2),\n      pickerMessages = _useState10[0],\n      setPickerMessages = _useState10[1];\n\n  (0, _react.useEffect)(function () {\n    // On mount; to avoid showing both imageries at once, we temporarily disable the parent catalog item.\n    catalogItem.isShown = false;\n    return function () {\n      // Re-enable on unmount\n      catalogItem.isShown = true;\n    };\n  }, []); // Duplicate the catalog item\n\n  (0, _react.useEffect)(function () {\n    var newItem = (0, _duplicateItem[\"default\"])(catalogItem, undefined, catalogItem.name + \" (copy)\");\n    newItem.isEnabled = true;\n    newItem.isShown = true;\n    newItem.useOwnClock = true;\n    setItem(newItem);\n  }, [catalogItem]);\n\n  function onUserPickLocation(picked, latLong) {\n    // TODO: If the item imagery has not loaded yet, features[] will be empty.\n    // Ideally, pick location should be called only after the item imagery has been loaded\n    // and we need some way to check that.\n    // IE has no array.find() so we use the clunkier for loop to find the feature.\n    var feature;\n\n    for (var i = 0; i < picked.features.length; i++) {\n      if (picked.features[i].imageryLayer === item.imageryLayer) {\n        feature = picked.features[i];\n        break;\n      }\n    }\n\n    if (feature) {\n      try {\n        item.filterIntervalsByFeature(feature, picked);\n        setDatesFromAvailableDates(item.availableDates);\n        setLocation(latLong);\n        setPickerMessages({\n          beforePick: \"Click another point to change the selection\",\n          afterPick: \"Click another point to change the selection\"\n        });\n      } catch (e) {\n        (0, _raiseErrorToUser[\"default\"])(terria, e);\n      }\n    } else {\n      setPickerMessages({\n        beforePick: \"Error when trying to resolve imagery at location! Please select a different location or zoom level.\",\n        afterPick: \"Click another point to change the selection\"\n      });\n    }\n  }\n\n  function cancelDeltaTool() {\n    if (item) item.isEnabled = false;\n    onCloseTool();\n  }\n\n  function generateDelta() {\n    var timestamp = (0, _dateformat[\"default\"])(new Date(), \"yyyy-mm-dd'T'HH:MM:ss.l'Z'\");\n    item.name = \"Change Detection: \".concat(catalogItem.name, \" \").concat(timestamp);\n    item.featureTimesProperty = undefined; // Hide the location filter\n\n    item.clock = undefined; // Make it a non-time-dynamic item\n\n    item.intervals = undefined;\n    item.supportsDeltaComparison = false;\n    item.disableUserChanges = true; // Hide controls like the style selector\n\n    var firstDateStr = dateDisplayFormat(primaryDate);\n    var secondDateStr = dateDisplayFormat(secondaryDate); // Trim lines to prevent <pre> wrapping during markdown conversion\n\n    item.shortReport = trimLines(\"\\n      \".concat(t(\"deltaTool.catalogItem.description\"), \"\\n\\n      **\").concat(t(\"deltaTool.primaryImage\"), \"**:   \").concat(firstDateStr, \"<br/>\\n      **\").concat(t(\"deltaTool.secondaryImage\"), \"**: \").concat(secondDateStr, \"\\n    \")); // item.loadingMessage = \"Loading difference map\";\n    // item.isLoading = true;\n\n    var firstDateParam = dateParamFormat(primaryDate);\n    var secondDateParam = dateParamFormat(secondaryDate);\n    item.parameters[\"time\"] = \"\".concat(firstDateParam, \",\").concat(secondDateParam);\n    item.showDeltaImagery(firstDateParam, secondDateParam);\n    onCloseTool();\n  } // Set primary & secondary dates to the last 2 available dates\n\n\n  function setDatesFromAvailableDates(availableDates) {\n    var _availableDates$slice = availableDates.slice(availableDates.length - 2),\n        _availableDates$slice2 = _slicedToArray(_availableDates$slice, 2),\n        primaryDate = _availableDates$slice2[0],\n        secondaryDate = _availableDates$slice2[1];\n\n    if (primaryDate) {\n      setPrimaryDate(primaryDate);\n      setSecondaryDate(secondaryDate || primaryDate);\n    }\n  }\n\n  return _react[\"default\"].createElement(\"div\", {\n    className: _deltaTool[\"default\"].deltaTool\n  }, _react[\"default\"].createElement(\"h1\", {\n    className: _deltaTool[\"default\"].title\n  }, t(\"deltaTool.titlePrefix\"), \": \", catalogItem.name), _react[\"default\"].createElement(\"div\", {\n    className: _deltaTool[\"default\"].body\n  }, _react[\"default\"].createElement(\"div\", null, _react[\"default\"].createElement(\"span\", null, t(\"deltaTool.description\")), location && _react[\"default\"].createElement(PrettyLocation, {\n    location: location\n  }), location === undefined ? _react[\"default\"].createElement(\"h3\", null, t(\"deltaTool.pickLocation\")) : _react[\"default\"].createElement(_DatePickers[\"default\"], {\n    item: item,\n    primaryDate: primaryDate,\n    setPrimaryDate: setPrimaryDate,\n    secondaryDate: secondaryDate,\n    setSecondaryDate: setSecondaryDate\n  })), _react[\"default\"].createElement(\"div\", {\n    className: _deltaTool[\"default\"].buttons\n  }, _react[\"default\"].createElement(\"button\", {\n    className: _deltaTool[\"default\"].cancelBtn,\n    onClick: cancelDeltaTool\n  }, t(\"deltaTool.cancelBtn\")), _react[\"default\"].createElement(\"button\", {\n    className: _deltaTool[\"default\"].generateDeltaBtn,\n    onClick: generateDelta,\n    disabled: location === undefined\n  }, t(\"deltaTool.generateDeltaBtn\")))), _react[\"default\"].createElement(_LocationPicker[\"default\"], {\n    terria: terria,\n    location: location,\n    onPick: onUserPickLocation,\n    messages: pickerMessages\n  }));\n}\n\nDeltaTool.propTypes = {\n  terria: _propTypes[\"default\"].object.isRequired,\n  tool: _propTypes[\"default\"].object.isRequired,\n  onCloseTool: _propTypes[\"default\"].func.isRequired,\n  t: _propTypes[\"default\"].func.isRequired\n};\nDeltaTool.displayName = \"DeltaTool\";\n\nfunction PrettyLocation(_ref2) {\n  var location = _ref2.location;\n\n  var _useTranslation = (0, _reactI18next.useTranslation)(),\n      t = _useTranslation.t;\n\n  var prettyLocation = (0, _prettifyCoordinates[\"default\"])(location.longitude, location.latitude);\n  return _react[\"default\"].createElement(\"section\", null, _react[\"default\"].createElement(\"h4\", null, t(\"deltaTool.selectedLocation\")), _react[\"default\"].createElement(\"div\", {\n    className: _deltaTool[\"default\"].location\n  }, prettyLocation.latitude, \", \", prettyLocation.longitude));\n}\n\nPrettyLocation.propTypes = {\n  location: _propTypes[\"default\"].object.isRequired\n};\nPrettyLocation.displayName = \"PrettyLocation\";\n\nfunction trimLines(text) {\n  return text.split(\"\\n\").map(function (ln) {\n    return ln.trim();\n  }).join(\"\\n\");\n}\n\nfunction dateParamFormat(date) {\n  return (0, _dateformat[\"default\"])(date, \"yyyy-mm-dd'T'HH:MM:ss.l'Z'\", true);\n}\n\nfunction dateDisplayFormat(date) {\n  return (0, _dateformat[\"default\"])(date, \"dd-mm-yyyy\", true);\n}\n\nvar _default = (0, _reactI18next.withTranslation)()(DeltaTool);\n\nexports[\"default\"] = _default;","\"use strict\";\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _dateformat = _interopRequireDefault(require(\"dateformat\"));\n\nvar _defined = _interopRequireDefault(require(\"terriajs-cesium/Source/Core/defined\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _DateFormats = require(\"../../BottomDock/Timeline/DateFormats\");\n\nvar _DateTimePicker = _interopRequireDefault(require(\"../../../ReactViews/BottomDock/Timeline/DateTimePicker.jsx\"));\n\nvar _Icon = _interopRequireDefault(require(\"../../Icon.jsx\"));\n\nvar _deltaTool = _interopRequireDefault(require(\"./delta-tool.scss\"));\n\nvar _reactI18next = require(\"react-i18next\");\n\nfunction _getRequireWildcardCache() { if (typeof WeakMap !== \"function\") return null; var cache = new WeakMap(); _getRequireWildcardCache = function _getRequireWildcardCache() { return cache; }; return cache; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\n/**\n * Primary and secondary date pickers for delta tool\n */\nfunction DatePickers(_ref) {\n  var item = _ref.item,\n      primaryDate = _ref.primaryDate,\n      setPrimaryDate = _ref.setPrimaryDate,\n      secondaryDate = _ref.secondaryDate,\n      setSecondaryDate = _ref.setSecondaryDate,\n      t = _ref.t;\n  var pickers = [useDatePickerState(), useDatePickerState()]; // Set a pickers state. If the target picker opens, close the other.\n\n  var _setIsOpen = function setIsOpen(pickerId, isOpen) {\n    var _ref2 = pickerId === 0 ? pickers : [pickers[1], pickers[0]],\n        _ref3 = _slicedToArray(_ref2, 2),\n        thisPicker = _ref3[0],\n        otherPicker = _ref3[1];\n\n    thisPicker.setIsOpen(isOpen);\n\n    if (isOpen) {\n      otherPicker.setIsOpen(false); // close other picker\n    }\n  };\n\n  var availableDates = item.availableDates;\n  var dateFormatting = item.dateFormat && item.dateFormat.currentTime;\n  return _react[\"default\"].createElement(\"div\", {\n    className: _deltaTool[\"default\"].datePickers\n  }, _react[\"default\"].createElement(\"section\", null, _react[\"default\"].createElement(\"h4\", null, t(\"deltaTool.primaryImage\")), _react[\"default\"].createElement(\"div\", {\n    title: \"Select a time\"\n  }, _react[\"default\"].createElement(DatePicker, {\n    date: primaryDate,\n    setDate: setPrimaryDate,\n    availableDates: availableDates,\n    dateFormatting: dateFormatting,\n    isOpen: pickers[0].isOpen,\n    setIsOpen: function setIsOpen(isOpen) {\n      return _setIsOpen(0, isOpen);\n    }\n  }))), _react[\"default\"].createElement(\"section\", null, _react[\"default\"].createElement(\"h4\", null, t(\"deltaTool.secondaryImage\")), _react[\"default\"].createElement(\"div\", {\n    title: \"Select a time\"\n  }, _react[\"default\"].createElement(DatePicker, {\n    date: secondaryDate,\n    setDate: setSecondaryDate,\n    availableDates: availableDates,\n    dateFormatting: dateFormatting,\n    isOpen: pickers[1].isOpen,\n    setIsOpen: function setIsOpen(isOpen) {\n      return _setIsOpen(1, isOpen);\n    }\n  }))));\n}\n\nDatePickers.propTypes = {\n  item: _propTypes[\"default\"].object.isRequired,\n  primaryDate: _propTypes[\"default\"].object.isRequired,\n  setPrimaryDate: _propTypes[\"default\"].func.isRequired,\n  secondaryDate: _propTypes[\"default\"].object.isRequired,\n  setSecondaryDate: _propTypes[\"default\"].func.isRequired,\n  t: _propTypes[\"default\"].func.isRequired\n};\n/**\n * Delta tool date picker\n */\n\nfunction DatePicker(_ref4) {\n  var date = _ref4.date,\n      availableDates = _ref4.availableDates,\n      setDate = _ref4.setDate,\n      dateFormatting = _ref4.dateFormatting,\n      isOpen = _ref4.isOpen,\n      setIsOpen = _ref4.setIsOpen;\n\n  var toggleOpen = function toggleOpen(e) {\n    setIsOpen(!isOpen);\n    e.stopPropagation();\n  };\n\n  var formattedDate = (0, _defined[\"default\"])(dateFormatting) ? (0, _dateformat[\"default\"])(date, dateFormatting) : (0, _DateFormats.formatDateTime)(date);\n\n  var _findNextAndPrevDates = findNextAndPrevDates(date, availableDates),\n      prevDate = _findNextAndPrevDates.prevDate,\n      nextDate = _findNextAndPrevDates.nextDate;\n\n  return _react[\"default\"].createElement(\"div\", null, _react[\"default\"].createElement(\"div\", {\n    className: _deltaTool[\"default\"].pickerButtons\n  }, _react[\"default\"].createElement(\"button\", {\n    className: _deltaTool[\"default\"].previousDate,\n    title: \"Previous time\",\n    disabled: !(0, _defined[\"default\"])(prevDate),\n    onClick: function onClick() {\n      return setDate(prevDate);\n    }\n  }, _react[\"default\"].createElement(_Icon[\"default\"], {\n    glyph: _Icon[\"default\"].GLYPHS.previous\n  })), _react[\"default\"].createElement(\"button\", {\n    className: _deltaTool[\"default\"].currentDate,\n    onClick: toggleOpen,\n    title: \"Select a time\"\n  }, (0, _defined[\"default\"])(formattedDate) ? formattedDate : \"Currently out of range.\"), _react[\"default\"].createElement(\"button\", {\n    className: _deltaTool[\"default\"].nextDate,\n    title: \"Next time\",\n    disabled: !(0, _defined[\"default\"])(nextDate),\n    onClick: function onClick() {\n      return setDate(nextDate);\n    }\n  }, _react[\"default\"].createElement(_Icon[\"default\"], {\n    glyph: _Icon[\"default\"].GLYPHS.next\n  }))), _react[\"default\"].createElement(\"div\", {\n    className: _deltaTool[\"default\"].picker\n  }, _react[\"default\"].createElement(_DateTimePicker[\"default\"], {\n    currentDate: date,\n    dates: availableDates,\n    onChange: setDate,\n    popupStyle: _deltaTool[\"default\"].datePickerPopup,\n    openDirection: \"none\",\n    isOpen: isOpen,\n    showCalendarButton: false,\n    onOpen: function onOpen() {\n      return setIsOpen(true);\n    },\n    onClose: function onClose() {\n      return setIsOpen(false);\n    }\n  })));\n}\n\nDatePicker.propTypes = {\n  date: _propTypes[\"default\"].object.isRequired,\n  setDate: _propTypes[\"default\"].func.isRequired,\n  availableDates: _propTypes[\"default\"].array.isRequired,\n  dateFormatting: _propTypes[\"default\"].string,\n  isOpen: _propTypes[\"default\"].bool,\n  setIsOpen: _propTypes[\"default\"].func.isRequired\n};\n\nfunction findNextAndPrevDates(date, availableDates) {\n  var dateIndex = availableDates.indexOf(date);\n  var prevDate = dateIndex > 0 ? availableDates[dateIndex - 1] : undefined;\n  var nextDate = dateIndex < availableDates.length - 1 ? availableDates[dateIndex + 1] : undefined;\n  return {\n    prevDate: prevDate,\n    nextDate: nextDate\n  };\n}\n\nfunction useDatePickerState() {\n  var _useState = (0, _react.useState)(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isOpen = _useState2[0],\n      setIsOpen = _useState2[1];\n\n  return {\n    isOpen: isOpen,\n    setIsOpen: setIsOpen\n  };\n}\n\nvar _default = (0, _reactI18next.withTranslation)()(DatePickers);\n\nexports[\"default\"] = _default;","\"use strict\";\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _Ellipsoid = _interopRequireDefault(require(\"terriajs-cesium/Source/Core/Ellipsoid\"));\n\nvar _Math = _interopRequireDefault(require(\"terriajs-cesium/Source/Core/Math\"));\n\nvar _knockout = _interopRequireDefault(require(\"terriajs-cesium/Source/ThirdParty/knockout\"));\n\nvar _LocationMarkerUtils = require(\"../../../Models/LocationMarkerUtils.js\");\n\nvar _MapInteractionMode = _interopRequireDefault(require(\"../../../Models/MapInteractionMode\"));\n\nvar _Loader = _interopRequireDefault(require(\"../../Loader\"));\n\nfunction _getRequireWildcardCache() { if (typeof WeakMap !== \"function\") return null; var cache = new WeakMap(); _getRequireWildcardCache = function _getRequireWildcardCache() { return cache; }; return cache; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\n/**\n * Allows user to pick a point on the map\n */\nfunction LocationPicker(_ref) {\n  var terria = _ref.terria,\n      messages = _ref.messages,\n      location = _ref.location,\n      onPick = _ref.onPick;\n  (0, _react.useEffect)(function () {\n    var currentPick;\n    var pickPointMode = new _MapInteractionMode[\"default\"]({\n      message: messages.beforePick\n    });\n    terria.mapInteractionModeStack.push(pickPointMode);\n    showMarker(location);\n\n    var subscription = _knockout[\"default\"].getObservable(pickPointMode, \"pickedFeatures\").subscribe(function (thisPick) {\n      currentPick = thisPick;\n\n      pickPointMode.customUi =\n      /* eslint-disable-line react/display-name */\n      function () {\n        return _react[\"default\"].createElement(_Loader[\"default\"], {\n          message: \"Querying \".concat(location ? \"new\" : \"\", \" position...\")\n        });\n      };\n\n      pickPointMode.message = function () {\n        return messages.afterPick;\n      };\n\n      var position = cartesianToDegrees(thisPick.pickPosition);\n      showMarker(position);\n      currentPick.allFeaturesAvailablePromise.then(function () {\n        if (currentPick === thisPick) {\n          onPick(thisPick, position);\n        }\n      });\n    });\n\n    return function () {\n      // disposer\n      currentPick = undefined;\n      subscription.dispose();\n      stopInteractionMode(pickPointMode);\n      (0, _LocationMarkerUtils.removeMarker)(terria);\n    };\n  });\n\n  var showMarker = function showMarker(location) {\n    if (location) {\n      (0, _LocationMarkerUtils.addMarker)(terria, {\n        name: \"User selection\",\n        location: location\n      });\n    }\n  };\n\n  var stopInteractionMode = function stopInteractionMode(pickPointMode) {\n    var _terria$mapInteractio = terria.mapInteractionModeStack.slice(-1),\n        _terria$mapInteractio2 = _slicedToArray(_terria$mapInteractio, 1),\n        currentMode = _terria$mapInteractio2[0];\n\n    if (currentMode === pickPointMode) {\n      terria.mapInteractionModeStack.pop();\n    }\n  };\n\n  return null;\n}\n\nLocationPicker.propTypes = {\n  terria: _propTypes[\"default\"].object.isRequired,\n  messages: _propTypes[\"default\"].object.isRequired,\n  location: _propTypes[\"default\"].object,\n  onPick: _propTypes[\"default\"].func.isRequired\n};\nLocationPicker.displayName = \"LocationPicker\";\n\nfunction cartesianToDegrees(cartesian) {\n  var carto = _Ellipsoid[\"default\"].WGS84.cartesianToCartographic(cartesian);\n\n  return {\n    longitude: _Math[\"default\"].toDegrees(carto.longitude),\n    latitude: _Math[\"default\"].toDegrees(carto.latitude)\n  };\n}\n\nvar _default = LocationPicker;\nexports[\"default\"] = _default;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"deltaTool\":\"tjs-delta-tool__deltaTool tjs-tool-panel__tool\",\"title\":\"tjs-delta-tool__title\",\"body\":\"tjs-delta-tool__body\",\"buttons\":\"tjs-delta-tool__buttons\",\"cancelBtn\":\"tjs-delta-tool__cancelBtn tjs-_buttons__btn-grey\",\"generateDeltaBtn\":\"tjs-delta-tool__generateDeltaBtn tjs-_buttons__btn tjs-_buttons__btn-primary\",\"location\":\"tjs-delta-tool__location\",\"datePickers\":\"tjs-delta-tool__datePickers\",\"pickerButtons\":\"tjs-delta-tool__pickerButtons\",\"currentDate\":\"tjs-delta-tool__currentDate tjs-_buttons__btn\",\"previousDate\":\"tjs-delta-tool__previousDate tjs-_buttons__btn\",\"nextDate\":\"tjs-delta-tool__nextDate tjs-_buttons__btn\",\"picker\":\"tjs-delta-tool__picker\",\"datePickerPopup\":\"tjs-delta-tool__datePickerPopup\"};"],"sourceRoot":""}