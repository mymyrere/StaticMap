((self||window).webpackJsonp=(self||window).webpackJsonp||[]).push([[7],{1628:function(e,t,n){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=m(n(167)),o=m(n(13)),l=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var t=y();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var l=r?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(n,o,l):n[o]=e[o]}n.default=e,t&&t.set(e,n);return n}(n(11)),i=m(n(123)),u=m(n(762)),c=m(n(1629)),s=m(n(1630)),f=m(n(755)),d=m(n(276)),p=n(26);function y(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return y=function(){return e},e}function m(e){return e&&e.__esModule?e:{default:e}}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,i=e[Symbol.iterator]();!(a=(l=i.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function v(e){var t=e.terria,n=e.tool,a=e.onCloseTool,o=e.t,d=n.type,p=n.item;if("delta"!==d||!p||!p.supportsDeltaComparison)return null;var y=b((0,l.useState)(void 0),2),m=y[0],v=y[1],h=b((0,l.useState)(void 0),2),D=h[0],k=h[1],O=b((0,l.useState)(p.discreteTime),2),P=O[0],S=O[1],E=b((0,l.useState)(p.discreteTime),2),w=E[0],T=E[1],M=b((0,l.useState)({beforePick:"Select a point by clicking on the map",afterPick:"Click another point to change the selection"}),2),C=M[0],I=M[1];return(0,l.useEffect)((function(){return p.isShown=!1,function(){p.isShown=!0}}),[]),(0,l.useEffect)((function(){var e=(0,f.default)(p,void 0,p.name+" (copy)");e.isEnabled=!0,e.isShown=!0,e.useOwnClock=!0,v(e)}),[p]),l.default.createElement("div",{className:u.default.deltaTool},l.default.createElement("h1",{className:u.default.title},o("deltaTool.titlePrefix"),": ",p.name),l.default.createElement("div",{className:u.default.body},l.default.createElement("div",null,l.default.createElement("span",null,o("deltaTool.description")),D&&l.default.createElement(g,{location:D}),void 0===D?l.default.createElement("h3",null,o("deltaTool.pickLocation")):l.default.createElement(c.default,{item:m,primaryDate:P,setPrimaryDate:S,secondaryDate:w,setSecondaryDate:T})),l.default.createElement("div",{className:u.default.buttons},l.default.createElement("button",{className:u.default.cancelBtn,onClick:function(){m&&(m.isEnabled=!1),a()}},o("deltaTool.cancelBtn")),l.default.createElement("button",{className:u.default.generateDeltaBtn,onClick:function(){var e=(0,r.default)(new Date,"yyyy-mm-dd'T'HH:MM:ss.l'Z'");m.name="Change Detection: ".concat(p.name," ").concat(e),m.featureTimesProperty=void 0,m.clock=void 0,m.intervals=void 0,m.supportsDeltaComparison=!1,m.disableUserChanges=!0;var t=j(P),n=j(w);m.shortReport="\n      ".concat(o("deltaTool.catalogItem.description"),"\n\n      **").concat(o("deltaTool.primaryImage"),"**:   ").concat(t,"<br/>\n      **").concat(o("deltaTool.secondaryImage"),"**: ").concat(n,"\n    ").split("\n").map((function(e){return e.trim()})).join("\n");var l=_(P),i=_(w);m.parameters.time="".concat(l,",").concat(i),m.showDeltaImagery(l,i),a()},disabled:void 0===D},o("deltaTool.generateDeltaBtn")))),l.default.createElement(s.default,{terria:t,location:D,onPick:function(e,n){for(var a,r=0;r<e.features.length;r++)if(e.features[r].imageryLayer===m.imageryLayer){a=e.features[r];break}if(a)try{m.filterIntervalsByFeature(a,e),function(e){var t=b(e.slice(e.length-2),2),n=t[0],a=t[1];n&&(S(n),T(a||n))}(m.availableDates),k(n),I({beforePick:"Click another point to change the selection",afterPick:"Click another point to change the selection"})}catch(e){(0,i.default)(t,e)}else I({beforePick:"Error when trying to resolve imagery at location! Please select a different location or zoom level.",afterPick:"Click another point to change the selection"})},messages:C}))}function g(e){var t=e.location,n=(0,p.useTranslation)().t,a=(0,d.default)(t.longitude,t.latitude);return l.default.createElement("section",null,l.default.createElement("h4",null,n("deltaTool.selectedLocation")),l.default.createElement("div",{className:u.default.location},a.latitude,", ",a.longitude))}function _(e){return(0,r.default)(e,"yyyy-mm-dd'T'HH:MM:ss.l'Z'",!0)}function j(e){return(0,r.default)(e,"dd-mm-yyyy",!0)}v.propTypes={terria:o.default.object.isRequired,tool:o.default.object.isRequired,onCloseTool:o.default.func.isRequired,t:o.default.func.isRequired},v.displayName="DeltaTool",g.propTypes={location:o.default.object.isRequired},g.displayName="PrettyLocation";var h=(0,p.withTranslation)()(v);t.default=h},1629:function(e,t,n){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=y(n(167)),o=y(n(8)),l=y(n(13)),i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var t=p();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var l=r?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(n,o,l):n[o]=e[o]}n.default=e,t&&t.set(e,n);return n}(n(11)),u=n(241),c=y(n(488)),s=y(n(36)),f=y(n(762)),d=n(26);function p(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return p=function(){return e},e}function y(e){return e&&e.__esModule?e:{default:e}}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,i=e[Symbol.iterator]();!(a=(l=i.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function b(e){var t=e.item,n=e.primaryDate,a=e.setPrimaryDate,r=e.secondaryDate,o=e.setSecondaryDate,l=e.t,u=[g(),g()],c=function(e,t){var n=m(0===e?u:[u[1],u[0]],2),a=n[0],r=n[1];a.setIsOpen(t),t&&r.setIsOpen(!1)},s=t.availableDates,d=t.dateFormat&&t.dateFormat.currentTime;return i.default.createElement("div",{className:f.default.datePickers},i.default.createElement("section",null,i.default.createElement("h4",null,l("deltaTool.primaryImage")),i.default.createElement("div",{title:"Select a time"},i.default.createElement(v,{date:n,setDate:a,availableDates:s,dateFormatting:d,isOpen:u[0].isOpen,setIsOpen:function(e){return c(0,e)}}))),i.default.createElement("section",null,i.default.createElement("h4",null,l("deltaTool.secondaryImage")),i.default.createElement("div",{title:"Select a time"},i.default.createElement(v,{date:r,setDate:o,availableDates:s,dateFormatting:d,isOpen:u[1].isOpen,setIsOpen:function(e){return c(1,e)}}))))}function v(e){var t=e.date,n=e.availableDates,a=e.setDate,l=e.dateFormatting,d=e.isOpen,p=e.setIsOpen,y=(0,o.default)(l)?(0,r.default)(t,l):(0,u.formatDateTime)(t),m=function(e,t){var n=t.indexOf(e),a=n>0?t[n-1]:void 0,r=n<t.length-1?t[n+1]:void 0;return{prevDate:a,nextDate:r}}(t,n),b=m.prevDate,v=m.nextDate;return i.default.createElement("div",null,i.default.createElement("div",{className:f.default.pickerButtons},i.default.createElement("button",{className:f.default.previousDate,title:"Previous time",disabled:!(0,o.default)(b),onClick:function(){return a(b)}},i.default.createElement(s.default,{glyph:s.default.GLYPHS.previous})),i.default.createElement("button",{className:f.default.currentDate,onClick:function(e){p(!d),e.stopPropagation()},title:"Select a time"},(0,o.default)(y)?y:"Currently out of range."),i.default.createElement("button",{className:f.default.nextDate,title:"Next time",disabled:!(0,o.default)(v),onClick:function(){return a(v)}},i.default.createElement(s.default,{glyph:s.default.GLYPHS.next}))),i.default.createElement("div",{className:f.default.picker},i.default.createElement(c.default,{currentDate:t,dates:n,onChange:a,popupStyle:f.default.datePickerPopup,openDirection:"none",isOpen:d,showCalendarButton:!1,onOpen:function(){return p(!0)},onClose:function(){return p(!1)}})))}function g(){var e=m((0,i.useState)(!1),2);return{isOpen:e[0],setIsOpen:e[1]}}b.propTypes={item:l.default.object.isRequired,primaryDate:l.default.object.isRequired,setPrimaryDate:l.default.func.isRequired,secondaryDate:l.default.object.isRequired,setSecondaryDate:l.default.func.isRequired,t:l.default.func.isRequired},v.propTypes={date:l.default.object.isRequired,setDate:l.default.func.isRequired,availableDates:l.default.array.isRequired,dateFormatting:l.default.string,isOpen:l.default.bool,setIsOpen:l.default.func.isRequired};var _=(0,d.withTranslation)()(b);t.default=_},1630:function(e,t,n){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=p(n(13)),o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var t=d();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var l=r?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(n,o,l):n[o]=e[o]}n.default=e,t&&t.set(e,n);return n}(n(11)),l=p(n(27)),i=p(n(14)),u=p(n(22)),c=n(209),s=p(n(164)),f=p(n(110));function d(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return d=function(){return e},e}function p(e){return e&&e.__esModule?e:{default:e}}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,i=e[Symbol.iterator]();!(a=(l=i.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function m(e){var t=e.terria,n=e.messages,a=e.location,r=e.onPick;(0,o.useEffect)((function(){var e,y=new s.default({message:n.beforePick});t.mapInteractionModeStack.push(y),d(a);var m=u.default.getObservable(y,"pickedFeatures").subscribe((function(t){e=t,y.customUi=function(){return o.default.createElement(f.default,{message:"Querying ".concat(a?"new":""," position...")})},y.message=function(){return n.afterPick};var u,c,s=(u=t.pickPosition,c=l.default.WGS84.cartesianToCartographic(u),{longitude:i.default.toDegrees(c.longitude),latitude:i.default.toDegrees(c.latitude)});d(s),e.allFeaturesAvailablePromise.then((function(){e===t&&r(t,s)}))}));return function(){e=void 0,m.dispose(),p(y),(0,c.removeMarker)(t)}}));var d=function(e){e&&(0,c.addMarker)(t,{name:"User selection",location:e})},p=function(e){y(t.mapInteractionModeStack.slice(-1),1)[0]===e&&t.mapInteractionModeStack.pop()};return null}m.propTypes={terria:r.default.object.isRequired,messages:r.default.object.isRequired,location:r.default.object,onPick:r.default.func.isRequired},m.displayName="LocationPicker";var b=m;t.default=b},762:function(e,t,n){e.exports={deltaTool:"tjs-delta-tool__deltaTool tjs-tool-panel__tool",title:"tjs-delta-tool__title",body:"tjs-delta-tool__body",buttons:"tjs-delta-tool__buttons",cancelBtn:"tjs-delta-tool__cancelBtn tjs-_buttons__btn-grey",generateDeltaBtn:"tjs-delta-tool__generateDeltaBtn tjs-_buttons__btn tjs-_buttons__btn-primary",location:"tjs-delta-tool__location",datePickers:"tjs-delta-tool__datePickers",pickerButtons:"tjs-delta-tool__pickerButtons",currentDate:"tjs-delta-tool__currentDate tjs-_buttons__btn",previousDate:"tjs-delta-tool__previousDate tjs-_buttons__btn",nextDate:"tjs-delta-tool__nextDate tjs-_buttons__btn",picker:"tjs-delta-tool__picker",datePickerPopup:"tjs-delta-tool__datePickerPopup"}}}]);
//# sourceMappingURL=7.TerriaMap.js.map